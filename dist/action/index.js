module.exports=function(e,t){"use strict";var r={};function __webpack_require__(t){if(r[t]){return r[t].exports}var n=r[t]={i:t,l:false,exports:{}};e[t].call(n.exports,n,n.exports,__webpack_require__);n.l=true;return n.exports}__webpack_require__.ab=__dirname+"/";function startup(){return __webpack_require__(960)}return startup()}({7:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const s=n(r(413));const o=r(304);const i=n(r(669));const a=i.default.debuglog("@moneyforward/stream-util/lines");class Lines extends s.default.Transform{constructor(e){super({objectMode:true,transform:(e,t,r)=>{try{a("%d: %s",this.count+=1,t);const n=(e=>{return Buffer.isBuffer(e)||e instanceof String||typeof e==="string"})(e);if(!n)return r(null,e);const s=this.decoder.write(e);const o=this.split(this.buffer+s);const i=o.pop();for(const e of o)this.push(e);this.buffer=i||"";r()}catch(e){r(e)}},flush:e=>{try{const t=this.decoder.end();const r=this.split(this.buffer+t);const n=r.pop();for(const e of r)this.push(e);if(n&&n.length)this.push(n);e()}catch(t){e(t)}}});this.count=0;this.decoder=new o.StringDecoder(e);this.buffer=""}split(e){return e.replace(/\r\n/g,"\n").split(/[\r\n]/)}}t.default=Lines},50:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.RubyGemsInstaller=void 0;const s=n(r(747));const o=n(r(87));const i=n(r(622));const a=n(r(413));const u=n(r(669));const c=r(891);const l=n(r(429));const f=u.default.debuglog("@moneyforward/sca-action-core/tool/installer");class RubyGemsInstaller{constructor(e=true,t=global.process){this.isStrict=e;this.process=t;this.dirctory=s.default.promises.mkdtemp(i.default.join(o.default.tmpdir(),"ruby-"));this.path=RubyGemsInstaller.addPath(this.dirctory,this.process.env);this.bundledGems=(async()=>{const e=new Map;const t=s.default.existsSync("Gemfile.lock")?s.default.createReadStream("Gemfile.lock"):a.default.Readable.from([]);const r=/^ {4}(.+) \((.+)\)$/;for await(const n of t.pipe(new c.transform.Lines)){const[t,s,o]=r.exec(n)||[];if(t)e.set(s,o)}return e})()}static async addPath(e,t=global.process.env){const r=await e;const n=t["GEM_PATH"]=[r,await l.default.substitute("gem",["env","path"])].join(i.default.delimiter);const s=t["PATH"]=[i.default.join(r,"bin"),t.PATH||""].join(i.default.delimiter);f("GEM_PATH=%s",n);f("PATH=%s",s);return s}async*resolve(e){const t=([e,t])=>`${e}${t&&":"+t||""}`;const r=await this.bundledGems;for await(const n of e)if(this.isStrict){yield t([n,r.get(n)])}else{for(const[e,s]of r){if(!e.startsWith(n))continue;const r=e[n.length];if(r===undefined||r==="_"||r==="-")yield t([e,s])}}}async execute(e=[]){return Promise.all([(async()=>{const t=["i","-N","-i",await this.dirctory];const r=new l.default("gem",t,undefined,async(e,r,n)=>n.slice(t.length));return c.reduce(r.execute(this.resolve(e)),(e,[t])=>{t.map(e=>e.split(":",2)).forEach(([t,r])=>e.set(t,r));return e},new Map)})(),this.path]).then(([e])=>e)}}t.RubyGemsInstaller=RubyGemsInstaller},70:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const s=n(r(407));t.JSON=s.default;const o=n(r(84));t.Lines=o.default},84:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const s=n(r(413));const o=r(304);const i=n(r(669));const a=i.default.debuglog("@moneyforward/stream-util/lines");class Lines extends s.default.Transform{constructor(e){super({objectMode:true,transform:(e,t,r)=>{try{a("%d: %s",this.count+=1,t);const n=(e=>{return Buffer.isBuffer(e)||e instanceof String||typeof e==="string"})(e);if(!n)return r(null,e);const s=this.decoder.write(e);const o=this.split(this.buffer+s);const i=o.pop();for(const e of o)this.push(e);this.buffer=i||"";r()}catch(e){r(e)}},flush:e=>{try{const t=this.decoder.end();const r=this.split(this.buffer+t);const n=r.pop();for(const e of r)this.push(e);if(n&&n.length)this.push(n);e()}catch(t){e(t)}}});this.count=0;this.decoder=new o.StringDecoder(e);this.buffer=""}split(e){return e.replace(/\r\n/g,"\n").split(/[\r\n]/)}}t.default=Lines},87:function(e){e.exports=require("os")},93:function(e,t,r){e.exports=minimatch;minimatch.Minimatch=Minimatch;var n={sep:"/"};try{n=r(622)}catch(e){}var s=minimatch.GLOBSTAR=Minimatch.GLOBSTAR={};var o=r(306);var i={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}};var a="[^/]";var u=a+"*?";var c="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?";var l="(?:(?!(?:\\/|^)\\.).)*?";var f=charSet("().*{}+?[]^$\\!");function charSet(e){return e.split("").reduce(function(e,t){e[t]=true;return e},{})}var d=/\/+/;minimatch.filter=filter;function filter(e,t){t=t||{};return function(r,n,s){return minimatch(r,e,t)}}function ext(e,t){e=e||{};t=t||{};var r={};Object.keys(t).forEach(function(e){r[e]=t[e]});Object.keys(e).forEach(function(t){r[t]=e[t]});return r}minimatch.defaults=function(e){if(!e||!Object.keys(e).length)return minimatch;var t=minimatch;var r=function minimatch(r,n,s){return t.minimatch(r,n,ext(e,s))};r.Minimatch=function Minimatch(r,n){return new t.Minimatch(r,ext(e,n))};return r};Minimatch.defaults=function(e){if(!e||!Object.keys(e).length)return Minimatch;return minimatch.defaults(e).Minimatch};function minimatch(e,t,r){if(typeof t!=="string"){throw new TypeError("glob pattern string required")}if(!r)r={};if(!r.nocomment&&t.charAt(0)==="#"){return false}if(t.trim()==="")return e==="";return new Minimatch(t,r).match(e)}function Minimatch(e,t){if(!(this instanceof Minimatch)){return new Minimatch(e,t)}if(typeof e!=="string"){throw new TypeError("glob pattern string required")}if(!t)t={};e=e.trim();if(n.sep!=="/"){e=e.split(n.sep).join("/")}this.options=t;this.set=[];this.pattern=e;this.regexp=null;this.negate=false;this.comment=false;this.empty=false;this.make()}Minimatch.prototype.debug=function(){};Minimatch.prototype.make=make;function make(){if(this._made)return;var e=this.pattern;var t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=true;return}if(!e){this.empty=true;return}this.parseNegate();var r=this.globSet=this.braceExpand();if(t.debug)this.debug=console.error;this.debug(this.pattern,r);r=this.globParts=r.map(function(e){return e.split(d)});this.debug(this.pattern,r);r=r.map(function(e,t,r){return e.map(this.parse,this)},this);this.debug(this.pattern,r);r=r.filter(function(e){return e.indexOf(false)===-1});this.debug(this.pattern,r);this.set=r}Minimatch.prototype.parseNegate=parseNegate;function parseNegate(){var e=this.pattern;var t=false;var r=this.options;var n=0;if(r.nonegate)return;for(var s=0,o=e.length;s<o&&e.charAt(s)==="!";s++){t=!t;n++}if(n)this.pattern=e.substr(n);this.negate=t}minimatch.braceExpand=function(e,t){return braceExpand(e,t)};Minimatch.prototype.braceExpand=braceExpand;function braceExpand(e,t){if(!t){if(this instanceof Minimatch){t=this.options}else{t={}}}e=typeof e==="undefined"?this.pattern:e;if(typeof e==="undefined"){throw new TypeError("undefined pattern")}if(t.nobrace||!e.match(/\{.*\}/)){return[e]}return o(e)}Minimatch.prototype.parse=parse;var p={};function parse(e,t){if(e.length>1024*64){throw new TypeError("pattern is too long")}var r=this.options;if(!r.noglobstar&&e==="**")return s;if(e==="")return"";var n="";var o=!!r.nocase;var c=false;var l=[];var d=[];var h;var m=false;var g=-1;var y=-1;var b=e.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)";var v=this;function clearStateChar(){if(h){switch(h){case"*":n+=u;o=true;break;case"?":n+=a;o=true;break;default:n+="\\"+h;break}v.debug("clearStateChar %j %j",h,n);h=false}}for(var _=0,S=e.length,w;_<S&&(w=e.charAt(_));_++){this.debug("%s\t%s %s %j",e,_,n,w);if(c&&f[w]){n+="\\"+w;c=false;continue}switch(w){case"/":return false;case"\\":clearStateChar();c=true;continue;case"?":case"*":case"+":case"@":case"!":this.debug("%s\t%s %s %j <-- stateChar",e,_,n,w);if(m){this.debug("  in class");if(w==="!"&&_===y+1)w="^";n+=w;continue}v.debug("call clearStateChar %j",h);clearStateChar();h=w;if(r.noext)clearStateChar();continue;case"(":if(m){n+="(";continue}if(!h){n+="\\(";continue}l.push({type:h,start:_-1,reStart:n.length,open:i[h].open,close:i[h].close});n+=h==="!"?"(?:(?!(?:":"(?:";this.debug("plType %j %j",h,n);h=false;continue;case")":if(m||!l.length){n+="\\)";continue}clearStateChar();o=true;var O=l.pop();n+=O.close;if(O.type==="!"){d.push(O)}O.reEnd=n.length;continue;case"|":if(m||!l.length||c){n+="\\|";c=false;continue}clearStateChar();n+="|";continue;case"[":clearStateChar();if(m){n+="\\"+w;continue}m=true;y=_;g=n.length;n+=w;continue;case"]":if(_===y+1||!m){n+="\\"+w;c=false;continue}if(m){var M=e.substring(y+1,_);try{RegExp("["+M+"]")}catch(e){var x=this.parse(M,p);n=n.substr(0,g)+"\\["+x[0]+"\\]";o=o||x[1];m=false;continue}}o=true;m=false;n+=w;continue;default:clearStateChar();if(c){c=false}else if(f[w]&&!(w==="^"&&m)){n+="\\"}n+=w}}if(m){M=e.substr(y+1);x=this.parse(M,p);n=n.substr(0,g)+"\\["+x[0];o=o||x[1]}for(O=l.pop();O;O=l.pop()){var R=n.slice(O.reStart+O.open.length);this.debug("setting tail",n,O);R=R.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(e,t,r){if(!r){r="\\"}return t+t+r+"|"});this.debug("tail=%j\n   %s",R,R,O,n);var j=O.type==="*"?u:O.type==="?"?a:"\\"+O.type;o=true;n=n.slice(0,O.reStart)+j+"\\("+R}clearStateChar();if(c){n+="\\\\"}var A=false;switch(n.charAt(0)){case".":case"[":case"(":A=true}for(var E=d.length-1;E>-1;E--){var T=d[E];var C=n.slice(0,T.reStart);var P=n.slice(T.reStart,T.reEnd-8);var $=n.slice(T.reEnd-8,T.reEnd);var D=n.slice(T.reEnd);$+=D;var N=C.split("(").length-1;var I=D;for(_=0;_<N;_++){I=I.replace(/\)[+*?]?/,"")}D=I;var z="";if(D===""&&t!==p){z="$"}var k=C+P+D+z+$;n=k}if(n!==""&&o){n="(?=.)"+n}if(A){n=b+n}if(t===p){return[n,o]}if(!o){return globUnescape(e)}var B=r.nocase?"i":"";try{var G=new RegExp("^"+n+"$",B)}catch(e){return new RegExp("$.")}G._glob=e;G._src=n;return G}minimatch.makeRe=function(e,t){return new Minimatch(e,t||{}).makeRe()};Minimatch.prototype.makeRe=makeRe;function makeRe(){if(this.regexp||this.regexp===false)return this.regexp;var e=this.set;if(!e.length){this.regexp=false;return this.regexp}var t=this.options;var r=t.noglobstar?u:t.dot?c:l;var n=t.nocase?"i":"";var o=e.map(function(e){return e.map(function(e){return e===s?r:typeof e==="string"?regExpEscape(e):e._src}).join("\\/")}).join("|");o="^(?:"+o+")$";if(this.negate)o="^(?!"+o+").*$";try{this.regexp=new RegExp(o,n)}catch(e){this.regexp=false}return this.regexp}minimatch.match=function(e,t,r){r=r||{};var n=new Minimatch(t,r);e=e.filter(function(e){return n.match(e)});if(n.options.nonull&&!e.length){e.push(t)}return e};Minimatch.prototype.match=match;function match(e,t){this.debug("match",e,this.pattern);if(this.comment)return false;if(this.empty)return e==="";if(e==="/"&&t)return true;var r=this.options;if(n.sep!=="/"){e=e.split(n.sep).join("/")}e=e.split(d);this.debug(this.pattern,"split",e);var s=this.set;this.debug(this.pattern,"set",s);var o;var i;for(i=e.length-1;i>=0;i--){o=e[i];if(o)break}for(i=0;i<s.length;i++){var a=s[i];var u=e;if(r.matchBase&&a.length===1){u=[o]}var c=this.matchOne(u,a,t);if(c){if(r.flipNegate)return true;return!this.negate}}if(r.flipNegate)return false;return this.negate}Minimatch.prototype.matchOne=function(e,t,r){var n=this.options;this.debug("matchOne",{this:this,file:e,pattern:t});this.debug("matchOne",e.length,t.length);for(var o=0,i=0,a=e.length,u=t.length;o<a&&i<u;o++,i++){this.debug("matchOne loop");var c=t[i];var l=e[o];this.debug(t,c,l);if(c===false)return false;if(c===s){this.debug("GLOBSTAR",[t,c,l]);var f=o;var d=i+1;if(d===u){this.debug("** at the end");for(;o<a;o++){if(e[o]==="."||e[o]===".."||!n.dot&&e[o].charAt(0)===".")return false}return true}while(f<a){var p=e[f];this.debug("\nglobstar while",e,f,t,d,p);if(this.matchOne(e.slice(f),t.slice(d),r)){this.debug("globstar found match!",f,a,p);return true}else{if(p==="."||p===".."||!n.dot&&p.charAt(0)==="."){this.debug("dot detected!",e,f,t,d);break}this.debug("globstar swallow a segment, and continue");f++}}if(r){this.debug("\n>>> no match, partial?",e,f,t,d);if(f===a)return true}return false}var h;if(typeof c==="string"){if(n.nocase){h=l.toLowerCase()===c.toLowerCase()}else{h=l===c}this.debug("string match",c,l,h)}else{h=l.match(c);this.debug("pattern match",c,l,h)}if(!h)return false}if(o===a&&i===u){return true}else if(o===a){return r}else if(i===u){var m=o===a-1&&e[o]==="";return m}throw new Error("wtf?")};function globUnescape(e){return e.replace(/\\(.)/g,"$1")}function regExpEscape(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}},129:function(e){e.exports=require("child_process")},281:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){function adopt(e){return e instanceof r?e:new r(function(t){t(e)})}return new(r||(r=Promise))(function(r,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){s(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:true});const s=r(297);function create(e,t){return n(this,void 0,void 0,function*(){return yield s.DefaultGlobber.create(e,t)})}t.create=create},297:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){function adopt(e){return e instanceof r?e:new r(function(t){t(e)})}return new(r||(r=Promise))(function(r,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){s(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})};var s=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof __values==="function"?__values(e):e[Symbol.iterator](),r={},verb("next"),verb("throw"),verb("return"),r[Symbol.asyncIterator]=function(){return this},r);function verb(t){r[t]=e[t]&&function(r){return new Promise(function(n,s){r=e[t](r),settle(n,s,r.done,r.value)})}}function settle(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}};var o=this&&this.__await||function(e){return this instanceof o?(this.v=e,this):new o(e)};var i=this&&this.__asyncGenerator||function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),s,i=[];return s={},verb("next"),verb("throw"),verb("return"),s[Symbol.asyncIterator]=function(){return this},s;function verb(e){if(n[e])s[e]=function(t){return new Promise(function(r,n){i.push([e,t,r,n])>1||resume(e,t)})}}function resume(e,t){try{step(n[e](t))}catch(e){settle(i[0][3],e)}}function step(e){e.value instanceof o?Promise.resolve(e.value.v).then(fulfill,reject):settle(i[0][2],e)}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){if(e(t),i.shift(),i.length)resume(i[0][0],i[0][1])}};Object.defineProperty(t,"__esModule",{value:true});const a=r(470);const u=r(747);const c=r(601);const l=r(622);const f=r(597);const d=r(327);const p=r(923);const h=r(728);const m=process.platform==="win32";class DefaultGlobber{constructor(e){this.patterns=[];this.searchPaths=[];this.options=c.getOptions(e)}getSearchPaths(){return this.searchPaths.slice()}glob(){var e,t;return n(this,void 0,void 0,function*(){const r=[];try{for(var n=s(this.globGenerator()),o;o=yield n.next(),!o.done;){const e=o.value;r.push(e)}}catch(t){e={error:t}}finally{try{if(o&&!o.done&&(t=n.return))yield t.call(n)}finally{if(e)throw e.error}}return r})}globGenerator(){return i(this,arguments,function*globGenerator_1(){const e=c.getOptions(this.options);const t=[];for(const r of this.patterns){t.push(r);if(e.implicitDescendants&&(r.trailingSeparator||r.segments[r.segments.length-1]!=="**")){t.push(new p.Pattern(r.negate,r.segments.concat("**")))}}const r=[];for(const e of f.getSearchPaths(t)){a.debug(`Search path '${e}'`);try{yield o(u.promises.lstat(e))}catch(e){if(e.code==="ENOENT"){continue}throw e}r.unshift(new h.SearchState(e,1))}const n=[];while(r.length){const s=r.pop();const i=f.match(t,s.path);const a=!!i||f.partialMatch(t,s.path);if(!i&&!a){continue}const c=yield o(DefaultGlobber.stat(s,e,n));if(!c){continue}if(c.isDirectory()){if(i&d.MatchKind.Directory){yield yield o(s.path)}else if(!a){continue}const e=s.level+1;const t=(yield o(u.promises.readdir(s.path))).map(t=>new h.SearchState(l.join(s.path,t),e));r.push(...t.reverse())}else if(i&d.MatchKind.File){yield yield o(s.path)}}})}static create(e,t){return n(this,void 0,void 0,function*(){const r=new DefaultGlobber(t);if(m){e=e.replace(/\r\n/g,"\n");e=e.replace(/\r/g,"\n")}const n=e.split("\n").map(e=>e.trim());for(const e of n){if(!e||e.startsWith("#")){continue}else{r.patterns.push(new p.Pattern(e))}}r.searchPaths.push(...f.getSearchPaths(r.patterns));return r})}static stat(e,t,r){return n(this,void 0,void 0,function*(){let n;if(t.followSymbolicLinks){try{n=yield u.promises.stat(e.path)}catch(r){if(r.code==="ENOENT"){if(t.omitBrokenSymbolicLinks){a.debug(`Broken symlink '${e.path}'`);return undefined}throw new Error(`No information found for the path '${e.path}'. This may indicate a broken symbolic link.`)}throw r}}else{n=yield u.promises.lstat(e.path)}if(n.isDirectory()&&t.followSymbolicLinks){const t=yield u.promises.realpath(e.path);while(r.length>=e.level){r.pop()}if(r.some(e=>e===t)){a.debug(`Symlink cycle detected for path '${e.path}' and realpath '${t}'`);return undefined}r.push(t)}return n})}}t.DefaultGlobber=DefaultGlobber},303:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){if(n===undefined)n=r;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,n){if(n===undefined)n=r;e[n]=t[r]});var s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(Object.hasOwnProperty.call(e,r))n(t,e,r);s(t,e);return t};var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.GlobFinder=t.PassThroughFinder=void 0;const a=i(r(747));const u=i(r(622));const c=o(r(281));class PassThroughFinder{find(e){return e.replace(/[\r\n]+/g,"\n").split("\n").filter(e=>e!=="")}}t.PassThroughFinder=PassThroughFinder;class GlobFinder{find(e){return async function*(){const t=await c.create(e);for await(const e of t.globGenerator()){if((await a.default.promises.stat(e)).isDirectory())continue;yield u.default.relative(process.cwd(),e)}}()}}t.GlobFinder=GlobFinder},304:function(e){e.exports=require("string_decoder")},306:function(e,t,r){var n=r(896);var s=r(621);e.exports=expandTop;var o="\0SLASH"+Math.random()+"\0";var i="\0OPEN"+Math.random()+"\0";var a="\0CLOSE"+Math.random()+"\0";var u="\0COMMA"+Math.random()+"\0";var c="\0PERIOD"+Math.random()+"\0";function numeric(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function escapeBraces(e){return e.split("\\\\").join(o).split("\\{").join(i).split("\\}").join(a).split("\\,").join(u).split("\\.").join(c)}function unescapeBraces(e){return e.split(o).join("\\").split(i).join("{").split(a).join("}").split(u).join(",").split(c).join(".")}function parseCommaParts(e){if(!e)return[""];var t=[];var r=s("{","}",e);if(!r)return e.split(",");var n=r.pre;var o=r.body;var i=r.post;var a=n.split(",");a[a.length-1]+="{"+o+"}";var u=parseCommaParts(i);if(i.length){a[a.length-1]+=u.shift();a.push.apply(a,u)}t.push.apply(t,a);return t}function expandTop(e){if(!e)return[];if(e.substr(0,2)==="{}"){e="\\{\\}"+e.substr(2)}return expand(escapeBraces(e),true).map(unescapeBraces)}function identity(e){return e}function embrace(e){return"{"+e+"}"}function isPadded(e){return/^-?0\d/.test(e)}function lte(e,t){return e<=t}function gte(e,t){return e>=t}function expand(e,t){var r=[];var o=s("{","}",e);if(!o||/\$$/.test(o.pre))return[e];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(o.body);var u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(o.body);var c=i||u;var l=o.body.indexOf(",")>=0;if(!c&&!l){if(o.post.match(/,.*\}/)){e=o.pre+"{"+o.body+a+o.post;return expand(e)}return[e]}var f;if(c){f=o.body.split(/\.\./)}else{f=parseCommaParts(o.body);if(f.length===1){f=expand(f[0],false).map(embrace);if(f.length===1){var d=o.post.length?expand(o.post,false):[""];return d.map(function(e){return o.pre+f[0]+e})}}}var p=o.pre;var d=o.post.length?expand(o.post,false):[""];var h;if(c){var m=numeric(f[0]);var g=numeric(f[1]);var y=Math.max(f[0].length,f[1].length);var b=f.length==3?Math.abs(numeric(f[2])):1;var v=lte;var _=g<m;if(_){b*=-1;v=gte}var S=f.some(isPadded);h=[];for(var w=m;v(w,g);w+=b){var O;if(u){O=String.fromCharCode(w);if(O==="\\")O=""}else{O=String(w);if(S){var M=y-O.length;if(M>0){var x=new Array(M+1).join("0");if(w<0)O="-"+x+O.slice(1);else O=x+O}}}h.push(O)}}else{h=n(f,function(e){return expand(e,false)})}for(var R=0;R<h.length;R++){for(var j=0;j<d.length;j++){var A=p+h[R]+d[j];if(!t||c||A)r.push(A)}}return r}},313:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const s=n(r(747));const o=n(r(87));const i=n(r(622));const a=n(r(669));const u=r(718);const c=a.default.debuglog("@moneyforward/sca-action-core/reporters/annotation-reporter");let l=(()=>{class AnnotationReporter{constructor(e,t,r){this.changeRanges=e;this.resolver=t;this.commandPrguments=r;this.numberOfWriters=0}async initialize(){const e=i.default.join(await s.default.promises.mkdtemp(i.default.join(o.default.tmpdir(),`-`)),"problem-matcher.json");c("%s",AnnotationReporter.problemMatchers);await s.default.promises.writeFile(e,AnnotationReporter.problemMatchers);console.log(`::add-matcher::${e}`)}async finalize(){for(const e of AnnotationReporter.problemMatcher.map(({owner:e})=>e))console.log("::remove-matcher owner=%s::",e)}createReportWriter(e,t){const r=this.numberOfWriters+=1;return new class AnnotationWriter extends u.ReportWriter{constructor(n){super({objectMode:true,write:(e,t,r)=>{this.numberOfProblems+=1;const s=n.resolver.resolve(e.file);const o=Number(e.line);const i=n.changeRanges.get(s)||[];c("%s:%d = %s",s,o,i);for(const[t,r]of i)if(o>=t&&o<=r){const t=Number(e.column);const r=[e.severity,e.code===undefined?"":` \`${e.code}\``,o,Number.isNaN(t)?"":`, column ${t}`,s,e.message].map(e=>typeof e==="number"?e:(e===undefined?"":String(e)).replace(/\s+/g," "));console.log("[%s] Detected%s problem at line %d%s of %s\t%s",...r);this.numberOfDetections+=1;break}r()},final:r=>{const[,s]=n.commandPrguments;const[,o]=t;const i=o.slice(s.length);c("AnnotationWriter # %d detected %d out of %d problems. (%d files)",this.writerNumber,this.numberOfDetections,this.numberOfProblems,i.length);r();e(new u.Statistic(this.numberOfProblems,this.numberOfDetections,i.length))}});this.writerNumber=r;this.numberOfProblems=0;this.numberOfDetections=0;c("Created AnnotationWriter #%d",r)}}(this)}}AnnotationReporter.problemMatcher=[{owner:"@moneyforward/sca-action-core/reporters/annotation-reporter#0",pattern:[{regexp:/^\[([^\t]+)\] Detected(?:| `([^\t]+)`) problem at line (\d+|NaN)(?:|, column (\d+|NaN)) of ([^\t]+)\t([^\t]+)$/.source,file:5,line:3,column:4,severity:1,message:6,code:2}]}];AnnotationReporter.problemMatchers=JSON.stringify({problemMatcher:AnnotationReporter.problemMatcher});return AnnotationReporter})();t.default=l},325:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){if(n===undefined)n=r;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,n){if(n===undefined)n=r;e[n]=t[r]});var s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(Object.hasOwnProperty.call(e,r))n(t,e,r);s(t,e);return t};var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const a=i(r(747));const u=i(r(87));const c=i(r(622));const l=i(r(413));const f=i(r(669));const d=i(r(526));const p=r(520);const h=o(r(391));const m=f.default.debuglog("@moneyforward/code-review-action-rails_best_practices-plugin");let g=(()=>{class Analyzer extends h.default{constructor(e=[]){super(Analyzer.command,e.concat(["-f","json","--silent"]),undefined,2,undefined,"Rails Best Practices")}static buildOutputFileOptions(){const e=a.default.mkdtempSync(c.default.join(u.default.tmpdir(),`${Analyzer.command}-`));const t=c.default.join(e,"output.json");return["--output-file",t]}async prepare(){console.log(`::group::Installing gems...`);try{await new h.installer.RubyGemsInstaller(true).execute([Analyzer.command])}finally{console.log(`::endgroup::`)}}createTransformStreams(){return[new p.transform.JSON,new l.default.Transform({objectMode:true,transform:function(e,t,r){m(`Detected %d problem(s).`,e.length);for(const t of e)this.push({file:t.filename,line:t.line_number,column:undefined,severity:"error",message:t.message,code:undefined});this.push(null);r()}})]}get Command(){return class extends d.default{constructor(e,t=[],r={},n,s=1,o=0){super(e,t,r,n,s,o+Analyzer.buildOutputFileOptions().map(d.default.sizeOf).reduce((e,t)=>e+t))}async configureArguments(e){const[t,r]=Analyzer.buildOutputFileOptions();await a.default.promises.writeFile(r,"");return this.args.concat(t,r,...e)}}}pipeline(e,t,...[,r]){const[n,s]=r.slice(this.args.length);m("%s %s",n,s);const o=this.createTransformStreams()||[];return new Promise((e,r)=>{const n=a.default.watch(s).on("error",r).once("change",(r,i)=>{const u=a.default.statSync(s);m("%s %s (%d bytes)",r,i,u.size);n.close();e([a.default.createReadStream(s),...o.concat(t)])})})}}Analyzer.command="rails_best_practices";return Analyzer})();t.default=g},327:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r;(function(e){e[e["None"]=0]="None";e[e["Directory"]=1]="Directory";e[e["File"]=2]="File";e[e["All"]=3]="All"})(r=t.MatchKind||(t.MatchKind={}))},357:function(e){e.exports=require("assert")},383:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});const n=r(357);const s=r(622);const o=r(972);const i=process.platform==="win32";class Path{constructor(e){this.segments=[];if(typeof e==="string"){n(e,`Parameter 'itemPath' must not be empty`);e=o.safeTrimTrailingSeparator(e);if(!o.hasRoot(e)){this.segments=e.split(s.sep)}else{let t=e;let r=o.dirname(t);while(r!==t){const e=s.basename(t);this.segments.unshift(e);t=r;r=o.dirname(t)}this.segments.unshift(t)}}else{n(e.length>0,`Parameter 'itemPath' must not be an empty array`);for(let t=0;t<e.length;t++){let r=e[t];n(r,`Parameter 'itemPath' must not contain any empty segments`);r=o.normalizeSeparators(e[t]);if(t===0&&o.hasRoot(r)){r=o.safeTrimTrailingSeparator(r);n(r===o.dirname(r),`Parameter 'itemPath' root segment contains information for multiple segments`);this.segments.push(r)}else{n(!r.includes(s.sep),`Parameter 'itemPath' contains unexpected path separators`);this.segments.push(r)}}}}toString(){let e=this.segments[0];let t=e.endsWith(s.sep)||i&&/^[A-Z]:$/i.test(e);for(let r=1;r<this.segments.length;r++){if(t){t=false}else{e+=s.sep}e+=this.segments[r]}return e}}t.Path=Path},391:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){if(n===undefined)n=r;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,n){if(n===undefined)n=r;e[n]=t[r]});var s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(Object.hasOwnProperty.call(e,r))n(t,e,r);s(t,e);return t};var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const a=r(357);const u=i(r(87));const c=i(r(622));const l=i(r(413));const f=i(r(669));const d=i(r(429));const p=o(r(891));const h=r(303);const m=r(718);const g=i(r(684));const y=f.default.promisify(l.default.pipeline);const b=f.default.debuglog("@moneyforward/sca-action-core");b("Node.js %s (arch: %s; platform: %s; cups: %d)",process.version,process.arch,process.platform,u.default.cpus().length);t.finder=o(r(303));t.installer=o(r(50));t.reporter=o(r(718));let v=(()=>{class StaticCodeAnalyzer{constructor(e,t=[],r={},n,s=h.PassThroughFinder,o){this.command=e;this.args=t;this.options=r;this.exitStatusThreshold=n;this.Finder=s;this.title=o;this.git=new g.default}get Command(){return d.default}get Reporter(){return StaticCodeAnalyzer.reporterRepository.get(this.reporterTypeNotation)}async pipeline(e,t,...[r,n,s]){b("pipelining `%s` with %d argument(s)... (options: %o)",r,n.length,s);const o=e||l.default.Readable.from([]);o.unpipe(process.stdout);const i=this.createTransformStreams()||[];return[o,...i.concat(t)]}async analyze(e="."){a.strict(process.env.GITHUB_BASE_REF,"Environment variable `GITHUB_BASE_REF` is undefined.");a.strict(process.env.GITHUB_SHA,"Environment variable `GITHUB_SHA` is undefined.");const t=(async()=>{const e=e=>/\bgithub\.com\b/.test(e.url)&&e.mirror==="fetch";const t=await p.first(p.filter(this.git.listRemote(),e));return this.git.measureChangeRanges(process.env.GITHUB_BASE_REF||"",process.env.GITHUB_SHA||"",t===null||t===void 0?void 0:t.name)})();const r=(async()=>{const e=await this.git.showCurrentDirectoryUp();const t=c.default.relative(c.default.resolve(process.cwd(),e),process.cwd());b("dirname: %s",t);return{resolve:e=>c.default.join(t,c.default.relative(process.cwd(),e))}})();const[n,s]=await Promise.all([t,r,this.prepare()]);console.log(`::group::Analyze code statically using ${this.title||this.command}`);try{const t=new this.Reporter(n,s,[this.command,this.args,this.options]);const r=async(e,...r)=>{return new Promise((n,s)=>{const o=t.createReportWriter(n,r);this.pipeline(e.stdout,o,...r).then(y).catch(s)})};const o=new this.Command(this.command,this.args,this.options,r,this.exitStatusThreshold);await t.initialize();try{const r=await p.arrayify(o.execute((new this.Finder).find(e)));const n=r.map(([e])=>e).reduce(m.Statistic.add,new m.Statistic);b("%o",n);console.log("Detected %d issue(s).",n.numberOfDetections);return n.numberOfDetections>0?1:0}finally{await t.finalize()}}finally{console.log(`::endgroup::`)}}}StaticCodeAnalyzer.reporterRepository=new m.ReporterRepository;return StaticCodeAnalyzer})();t.default=v},407:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const s=n(r(413));const o=n(r(669));const i=o.default.debuglog("@moneyforward/stream-util/json");class JSON extends s.default.Transform{constructor(){super({readableObjectMode:true,writableObjectMode:false,transform:(e,t,r)=>{i("%d: %s",this.count+=1,t);const n=Buffer.isBuffer(e)?e:Buffer.from(e,t);this.buffers.push(n);r()},flush:e=>{try{const t=Buffer.concat(this.buffers).toString();i("%s",t);const r=global.JSON.parse(t);e(null,r)}catch(t){e(t)}}});this.count=0;this.buffers=[]}}t.default=JSON},413:function(e){e.exports=require("stream")},429:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const s=r(129);const o=n(r(87));const i=n(r(669));const a=r(891);const u=i.default.debuglog("@moneyforward/command");let c=(()=>{class Command{constructor(e,t=[],r={},n,s=1,o=0){this.command=e;this.args=t;this.options=r;this.promisify=n;this.parallelism=Command.defaultParallelism;this.argumentCountThreshold=Number.POSITIVE_INFINITY;this.initArgumentsSize=Command.calculateInitArgumentsSize(this.command,this.args,o);this.evaluateExitStatus=typeof s==="number"?e=>e<s:s}static sizeOf(e){return Buffer.from(e).length}static sizeOfEnvironment(e){return Object.entries(e).map(([e,t])=>Command.sizeOf(`${e}=${t}`)).reduce((e,t)=>e+t,0)}static calculateMaxArgumentsSize(e=global.process){return e.platform==="win32"?8191:131072-2048-Command.sizeOfEnvironment(e.env)}static calculateInitArgumentsSize(e,t,r){return[e].concat(t).map(Command.sizeOf).reduce((e,t)=>e+t)+Math.max(0,r)}static async execute(e,t=[],r={},n=1,s,o=(e=>e<n),[i,u]=[e=>e,undefined]){const c=new Command(e,t,r,s,o).execute();return a.reduce(c,i,u)}static async substitute(e,t=[],r,n){const s=new Command(e,t,Object.assign({},r,{stdio:[n,"pipe","ignore"]}),async e=>{if(e.stdout===null)return"";e.stdout.unpipe(process.stdout);return a.stringify(e.stdout)}).execute();return a.arrayify(s).then(e=>e.map(([e])=>e).join().replace(/((\r\n)+|\n+)$/,"")).catch(e=>{u("%s",e);return""})}async configureArguments(e){return this.args.concat(e)}async _execute(e){const t=await this.configureArguments(e);return new Promise((e,r)=>{let n;const o=[this.command,t,this.options];const i=s.spawn(...o).once("error",r).once("exit",e=>n=e).once("close",e=>u("`%s` command closed. (%d)",this.command,e));i.stdout&&i.stdout.pipe(process.stdout);i.stderr&&i.stderr.pipe(process.stderr);const a=this.promisify?this.promisify(i,...o):Promise.resolve();a.catch(r);const c=t=>{if(t===null||!this.evaluateExitStatus(t))return r(t);a.then(r=>e([r,t]))};if(n!==undefined)c(n);i.once("exit",c)})}async*execute(e){u("parallelism: %d",this.parallelism);function drain(e,t){const r=e.length<t?[]:e.splice(0);u("drain %d values.",r.length);return r}let t=0;const r=[];const n=(e,n=0)=>{r.push(this._execute(e));t+=1;u("%d: Promise to execute `%s` (arguments length: %d)",t,this.command,e.length);return drain(r,n)};try{if(e===undefined){yield*n([]);return}const r=Command.calculateMaxArgumentsSize();const s=[];let o=this.initArgumentsSize;let i=0;for await(const t of e){const e=Command.sizeOf(t);if(e+o>r||i+1>this.argumentCountThreshold){yield*n(s,this.parallelism);s.length=0;o=this.initArgumentsSize;i=0}s.push(t);o+=e;i+=1}if(s.length)yield*n(s)}finally{u("%s %d promise(s)",this.command,t)}}}Command.defaultParallelism=o.default.cpus().length;return Command})();t.default=c},431:function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(Object.hasOwnProperty.call(e,r))t[r]=e[r];t["default"]=e;return t};Object.defineProperty(t,"__esModule",{value:true});const s=n(r(87));function issueCommand(e,t,r){const n=new Command(e,t,r);process.stdout.write(n.toString()+s.EOL)}t.issueCommand=issueCommand;function issue(e,t=""){issueCommand(e,{},t)}t.issue=issue;const o="::";class Command{constructor(e,t,r){if(!e){e="missing.command"}this.command=e;this.properties=t;this.message=r}toString(){let e=o+this.command;if(this.properties&&Object.keys(this.properties).length>0){e+=" ";let t=true;for(const r in this.properties){if(this.properties.hasOwnProperty(r)){const n=this.properties[r];if(n){if(t){t=false}else{e+=","}e+=`${r}=${escapeProperty(n)}`}}}}e+=`${o}${escapeData(this.message)}`;return e}}function toCommandValue(e){if(e===null||e===undefined){return""}else if(typeof e==="string"||e instanceof String){return e}return JSON.stringify(e)}t.toCommandValue=toCommandValue;function escapeData(e){return toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function escapeProperty(e){return toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}},453:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){if(n===undefined)n=r;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,n){if(n===undefined)n=r;e[n]=t[r]});var s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(Object.hasOwnProperty.call(e,r))n(t,e,r);s(t,e);return t};var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const a=i(r(669));const u=a.default.debuglog("@moneyforward/code-review-action");class CodeReviewAction{constructor(e){if(e){this.module=Promise.resolve({default:e})}else{if(!process.env.INPUT_ANALYZER)throw new TypeError("Environment variable `INPUT_ANALYZER` is undefined.");this.module=Promise.resolve().then(()=>o(require(process.env.INPUT_ANALYZER)))}this.files=process.env.INPUT_FILES||".";const t=process.env.INPUT_OPTIONS?JSON.parse(process.env.INPUT_OPTIONS):[];this.args=[].concat(t);const r=process.env.INPUT_WORKING_DIRECTORY;r&&process.chdir(r);this.reporterTypeNotation=process.env.INPUT_REPORTER_TYPE_NOTATION}async execute(){const e=await this.module;u("%s",e);const t=e.default;const r=new t(...this.args);r.reporterTypeNotation=this.reporterTypeNotation;return await r.analyze(this.files)}}t.default=CodeReviewAction},470:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){function adopt(e){return e instanceof r?e:new r(function(t){t(e)})}return new(r||(r=Promise))(function(r,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){s(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})};var s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(Object.hasOwnProperty.call(e,r))t[r]=e[r];t["default"]=e;return t};Object.defineProperty(t,"__esModule",{value:true});const o=r(431);const i=s(r(87));const a=s(r(622));var u;(function(e){e[e["Success"]=0]="Success";e[e["Failure"]=1]="Failure"})(u=t.ExitCode||(t.ExitCode={}));function exportVariable(e,t){const r=o.toCommandValue(t);process.env[e]=r;o.issueCommand("set-env",{name:e},r)}t.exportVariable=exportVariable;function setSecret(e){o.issueCommand("add-mask",{},e)}t.setSecret=setSecret;function addPath(e){o.issueCommand("add-path",{},e);process.env["PATH"]=`${e}${a.delimiter}${process.env["PATH"]}`}t.addPath=addPath;function getInput(e,t){const r=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!r){throw new Error(`Input required and not supplied: ${e}`)}return r.trim()}t.getInput=getInput;function setOutput(e,t){o.issueCommand("set-output",{name:e},t)}t.setOutput=setOutput;function setCommandEcho(e){o.issue("echo",e?"on":"off")}t.setCommandEcho=setCommandEcho;function setFailed(e){process.exitCode=u.Failure;error(e)}t.setFailed=setFailed;function isDebug(){return process.env["RUNNER_DEBUG"]==="1"}t.isDebug=isDebug;function debug(e){o.issueCommand("debug",{},e)}t.debug=debug;function error(e){o.issue("error",e instanceof Error?e.toString():e)}t.error=error;function warning(e){o.issue("warning",e instanceof Error?e.toString():e)}t.warning=warning;function info(e){process.stdout.write(e+i.EOL)}t.info=info;function startGroup(e){o.issue("group",e)}t.startGroup=startGroup;function endGroup(){o.issue("endgroup")}t.endGroup=endGroup;function group(e,t){return n(this,void 0,void 0,function*(){startGroup(e);let r;try{r=yield t()}finally{endGroup()}return r})}t.group=group;function saveState(e,t){o.issueCommand("save-state",{name:e},t)}t.saveState=saveState;function getState(e){return process.env[`STATE_${e}`]||""}t.getState=getState},520:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};var s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(Object.hasOwnProperty.call(e,r))t[r]=e[r];t["default"]=e;return t};Object.defineProperty(t,"__esModule",{value:true});const o=n(r(413));t.transform=s(r(70));async function*concat(...e){for(const t of e)yield*t}t.concat=concat;async function*map(e,t){let r=-1;for await(const n of e)yield t(n,r+=1)}t.map=map;async function*filter(e,t){let r=-1;for await(const n of e)if(t(n,r+=1))yield n}t.filter=filter;async function reduce(e,t,r){const n=e[Symbol.asyncIterator]();let s;if((s=await n.next()).done){if(r===undefined){throw new TypeError("Reduce of empty array with no initial value")}else{return r}}let o=0;let i=r===undefined?s.value:t(r,s.value,o);while(true){if((s=await n.next()).done)return i;i=t(i,s.value,o+=1)}}t.reduce=reduce;async function first(e){for await(const t of e)return t}t.first=first;async function count(e){return reduce(e,e=>e+1,0)}t.count=count;async function arrayify(e){return reduce(e,(e,t)=>{e.push(t);return e},[])}t.arrayify=arrayify;async function _stringify(e){const t=e=>e.readableObjectMode;const r=e=>{function readableEncoding(e){const t=e.readableEncoding;if(t!==undefined)return t;return e._readableState?e._readableState.encoding:null}return readableEncoding(e)!==null};if(t(e)||r(e)){return reduce(e,(e,t)=>e+String(t),"")}else{const t=e;return Buffer.concat(await arrayify(t)).toString()}}async function stringify(e){if(e instanceof o.default.Readable)return _stringify(e);return reduce(e,(e,t)=>e+String(t),"")}t.stringify=stringify;async function*of(...e){yield*e}t.of=of},526:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const s=r(129);const o=n(r(87));const i=n(r(669));const a=r(520);const u=i.default.debuglog("@moneyforward/command");let c=(()=>{class Command{constructor(e,t=[],r={},n,s=1,o=0){this.command=e;this.args=t;this.options=r;this.promisify=n;this.parallelism=Command.defaultParallelism;this.argumentCountThreshold=Number.POSITIVE_INFINITY;this.initArgumentsSize=Command.calculateInitArgumentsSize(this.command,this.args,o);this.evaluateExitStatus=typeof s==="number"?e=>e<s:s}static sizeOf(e){return Buffer.from(e).length}static sizeOfEnvironment(e){return Object.entries(e).map(([e,t])=>Command.sizeOf(`${e}=${t}`)).reduce((e,t)=>e+t,0)}static calculateMaxArgumentsSize(e=global.process){return e.platform==="win32"?8191:131072-2048-Command.sizeOfEnvironment(e.env)}static calculateInitArgumentsSize(e,t,r){return[e].concat(t).map(Command.sizeOf).reduce((e,t)=>e+t)+Math.max(0,r)}static async execute(e,t=[],r={},n=1,s,o=(e=>e<n),[i,u]=[e=>e,undefined]){const c=new Command(e,t,r,s,o).execute();return a.reduce(c,i,u)}static async substitute(e,t=[],r,n){const s=new Command(e,t,Object.assign({},r,{stdio:[n,"pipe","ignore"]}),async e=>{if(e.stdout===null)return"";e.stdout.unpipe(process.stdout);return a.stringify(e.stdout)}).execute();return a.arrayify(s).then(e=>e.map(([e])=>e).join().replace(/((\r\n)+|\n+)$/,"")).catch(e=>{u("%s",e);return""})}async configureArguments(e){return this.args.concat(e)}async _execute(e){const t=await this.configureArguments(e);return new Promise((e,r)=>{let n;const o=[this.command,t,this.options];const i=s.spawn(...o).once("error",r).once("exit",e=>n=e).once("close",e=>u("`%s` command closed. (%d)",this.command,e));i.stdout&&i.stdout.pipe(process.stdout);i.stderr&&i.stderr.pipe(process.stderr);const a=this.promisify?this.promisify(i,...o):Promise.resolve();a.catch(r);const c=t=>{if(t===null||!this.evaluateExitStatus(t))return r(t);a.then(r=>e([r,t]))};if(n!==undefined)c(n);i.once("exit",c)})}async*execute(e){u("parallelism: %d",this.parallelism);function drain(e,t){const r=e.length<t?[]:e.splice(0);u("drain %d values.",r.length);return r}let t=0;const r=[];const n=(e,n=0)=>{r.push(this._execute(e));t+=1;u("%d: Promise to execute `%s` (arguments length: %d)",t,this.command,e.length);return drain(r,n)};try{if(e===undefined){yield*n([]);return}const r=Command.calculateMaxArgumentsSize();const s=[];let o=this.initArgumentsSize;let i=0;for await(const t of e){const e=Command.sizeOf(t);if(e+o>r||i+1>this.argumentCountThreshold){yield*n(s,this.parallelism);s.length=0;o=this.initArgumentsSize;i=0}s.push(t);o+=e;i+=1}if(s.length)yield*n(s)}finally{u("%s %d promise(s)",this.command,t)}}}Command.defaultParallelism=o.default.cpus().length;return Command})();t.default=c},597:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});const n=r(972);const s=r(327);const o=process.platform==="win32";function getSearchPaths(e){e=e.filter(e=>!e.negate);const t={};for(const r of e){const e=o?r.searchPath.toUpperCase():r.searchPath;t[e]="candidate"}const r=[];for(const s of e){const e=o?s.searchPath.toUpperCase():s.searchPath;if(t[e]==="included"){continue}let i=false;let a=e;let u=n.dirname(a);while(u!==a){if(t[u]){i=true;break}a=u;u=n.dirname(a)}if(!i){r.push(s.searchPath);t[e]="included"}}return r}t.getSearchPaths=getSearchPaths;function match(e,t){let r=s.MatchKind.None;for(const n of e){if(n.negate){r&=~n.match(t)}else{r|=n.match(t)}}return r}t.match=match;function partialMatch(e,t){return e.some(e=>!e.negate&&e.partialMatch(t))}t.partialMatch=partialMatch},601:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});const n=r(470);function getOptions(e){const t={followSymbolicLinks:true,implicitDescendants:true,omitBrokenSymbolicLinks:true};if(e){if(typeof e.followSymbolicLinks==="boolean"){t.followSymbolicLinks=e.followSymbolicLinks;n.debug(`followSymbolicLinks '${t.followSymbolicLinks}'`)}if(typeof e.implicitDescendants==="boolean"){t.implicitDescendants=e.implicitDescendants;n.debug(`implicitDescendants '${t.implicitDescendants}'`)}if(typeof e.omitBrokenSymbolicLinks==="boolean"){t.omitBrokenSymbolicLinks=e.omitBrokenSymbolicLinks;n.debug(`omitBrokenSymbolicLinks '${t.omitBrokenSymbolicLinks}'`)}}return t}t.getOptions=getOptions},621:function(e){"use strict";e.exports=balanced;function balanced(e,t,r){if(e instanceof RegExp)e=maybeMatch(e,r);if(t instanceof RegExp)t=maybeMatch(t,r);var n=range(e,t,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+e.length,n[1]),post:r.slice(n[1]+t.length)}}function maybeMatch(e,t){var r=t.match(e);return r?r[0]:null}balanced.range=range;function range(e,t,r){var n,s,o,i,a;var u=r.indexOf(e);var c=r.indexOf(t,u+1);var l=u;if(u>=0&&c>0){n=[];o=r.length;while(l>=0&&!a){if(l==u){n.push(l);u=r.indexOf(e,l+1)}else if(n.length==1){a=[n.pop(),c]}else{s=n.pop();if(s<o){o=s;i=c}c=r.indexOf(t,l+1)}l=u<c&&u>=0?u:c}if(n.length){a=[o,i]}}return a}},622:function(e){e.exports=require("path")},669:function(e){e.exports=require("util")},684:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const s=n(r(413));const o=n(r(669));const i=n(r(429));const a=r(891);const u=o.default.debuglog("@moneyforward/sca-action-core/tool/git");class Git{async fetchShallow(e,t,r=1){const n=["fetch","-q",`--depth=${r}`];e&&n.push(e);t&&n.push(t);return i.default.execute("git",n)}async parseRevision(e,t){const r=`${t?`${t}/`:""}${e}`;return i.default.substitute("git",["rev-parse","--verify","-q",r])}async*listRemote(){const e=new i.default("git",["remote","-v"],undefined,async e=>{e.stdout&&e.stdout.unpipe(process.stdout);const t=e.stdout?e.stdout.pipe(new a.transform.Lines):s.default.Readable.from([]);return async function*(e){for await(const t of e){const[e,r,n,s]=/^(.+)\t(.+) \((fetch|push)\)$/.exec(t)||[];if(e)yield{name:r,url:n,mirror:s==="fetch"?"fetch":"push"}}}(t)}).execute();for await(const[t]of e)yield*t}async*diff(e,t,r="none"){const n=["--no-pager","diff","--no-prefix","--no-color","-U0","--diff-filter=b"];const o=t===undefined?[e]:r==="none"?[e,t]:[`${e}${r}${t}`];u("%s",o.join(" "));const c=new i.default("git",n,undefined,async e=>{e.stdout&&e.stdout.unpipe(process.stdout);return e.stdout?e.stdout.pipe(new a.transform.Lines):s.default.Readable.from([])}).execute(o);for await(const[e]of c)yield*e}async measureChangeRanges(e,t,r){u("%s...%s",e,t);const[n,s]=await a.arrayify(a.map(a.of(e,t),async e=>{const t=await this.parseRevision(e);if(t!==""||r===undefined)return t;await this.fetchShallow(r,e);return this.parseRevision(e,r)}));const o=new Map;let i="";for await(const e of this.diff(n,s,"..."))if(/^([@]{2}|[+]{3})\s/.test(e)){if(/^[+]{3}\s/.test(e)){i=e.substring("+++ ".length);continue}const t=((/^@@ (.*) @@.*$/.exec(e)||[])[1]||"").split(" ");const[r,n=1]=t[t.length-1].split(",").map(Number).map(Math.abs);u("%s:%d,%d",i,r,n);const s=o.get(i)||[];o.set(i,s.concat([[r,r+n-1]]))}return o}async showCurrentDirectoryUp(){return i.default.substitute("git",["rev-parse","--show-cdup"])}}t.default=Git},718:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.ReporterRepository=t.Statistic=t.ReportWriter=void 0;const s=n(r(413));const o=n(r(669));const i=n(r(313));const a=n(r(757));const u=o.default.debuglog("@moneyforward/sca-action-core/reporter");class ReportWriter extends s.default.Writable{}t.ReportWriter=ReportWriter;class Statistic{constructor(e=0,t=0,r=0){this.numberOfProblems=e;this.numberOfDetections=t;this.numberOfFiles=r}static add(e,t){return new Statistic(e.numberOfProblems+t.numberOfProblems,e.numberOfDetections+t.numberOfDetections,e.numberOfFiles+t.numberOfFiles)}}t.Statistic=Statistic;let c=(()=>{class ReporterRepository{constructor(){this.repository=new Map([ReporterRepository.defaultReporterType,a.default].map(e=>[e.name,e]))}static createMulticasterType(...e){u("ReporterTypes: %s",e);return class Multicaster{constructor(t,r,n){this.reporters=e.map(e=>new e(t,r,n))}initialize(){return Promise.all(this.reporters.map(e=>e.initialize()))}finalize(){return Promise.all(this.reporters.map(e=>e.finalize()))}createReportWriter(e,t){const r=new Map;const n=this.reporters.map(s=>s.createReportWriter(t=>{if(r.has(s))return;r.set(s,t);if(r.size===n.length){Promise.all(r.values()).then(t=>e(t.reduce(Statistic.add)))}},t));const o=new s.default.PassThrough({objectMode:true});for(const e of n)s.default.pipeline(o,e,e=>e&&u("%o",e));return o}}}set(e,t){const r=t||e.name;u("setting %s...",r);this.repository.set(r,e)}get(e){const t=e=>{return(e||"").split(",").map(e=>e?e:undefined).map(e=>this.repository.get(e)||ReporterRepository.defaultReporterType)};const[r,...n]=t(e);return n.length>0?ReporterRepository.createMulticasterType(r,...n):r}}ReporterRepository.defaultReporterType=i.default;return ReporterRepository})();t.ReporterRepository=c},728:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});class SearchState{constructor(e,t){this.path=e;this.level=t}}t.SearchState=SearchState},747:function(e){e.exports=require("fs")},757:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const s=n(r(413));const o=r(718);class NopReporter{constructor(e,t,r){this.changeRanges=e;this.resolver=t;this.commandPrguments=r;this.initialize=(()=>Promise.resolve());this.finalize=(()=>Promise.resolve())}createReportWriter(e){return new s.default.Writable({objectMode:true,write:(e,t,r)=>{r()},final:t=>{t();e(new o.Statistic)}})}}t.default=NopReporter},891:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};var s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(Object.hasOwnProperty.call(e,r))t[r]=e[r];t["default"]=e;return t};Object.defineProperty(t,"__esModule",{value:true});const o=n(r(413));t.transform=s(r(993));async function*concat(...e){for(const t of e)yield*t}t.concat=concat;async function*map(e,t){let r=-1;for await(const n of e)yield t(n,r+=1)}t.map=map;async function*filter(e,t){let r=-1;for await(const n of e)if(t(n,r+=1))yield n}t.filter=filter;async function reduce(e,t,r){const n=e[Symbol.asyncIterator]();let s;if((s=await n.next()).done){if(r===undefined){throw new TypeError("Reduce of empty array with no initial value")}else{return r}}let o=0;let i=r===undefined?s.value:t(r,s.value,o);while(true){if((s=await n.next()).done)return i;i=t(i,s.value,o+=1)}}t.reduce=reduce;async function first(e){for await(const t of e)return t}t.first=first;async function count(e){return reduce(e,e=>e+1,0)}t.count=count;async function arrayify(e){return reduce(e,(e,t)=>{e.push(t);return e},[])}t.arrayify=arrayify;async function _stringify(e){const t=e=>e.readableObjectMode;const r=e=>{function readableEncoding(e){const t=e.readableEncoding;if(t!==undefined)return t;return e._readableState?e._readableState.encoding:null}return readableEncoding(e)!==null};if(t(e)||r(e)){return reduce(e,(e,t)=>e+String(t),"")}else{const t=e;return Buffer.concat(await arrayify(t)).toString()}}async function stringify(e){if(e instanceof o.default.Readable)return _stringify(e);return reduce(e,(e,t)=>e+String(t),"")}t.stringify=stringify;async function*of(...e){yield*e}t.of=of},896:function(e){e.exports=function(e,r){var n=[];for(var s=0;s<e.length;s++){var o=r(e[s],s);if(t(o))n.push.apply(n,o);else n.push(o)}return n};var t=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"}},920:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const s=n(r(413));const o=n(r(669));const i=o.default.debuglog("@moneyforward/stream-util/json");class JSON extends s.default.Transform{constructor(){super({readableObjectMode:true,writableObjectMode:false,transform:(e,t,r)=>{i("%d: %s",this.count+=1,t);const n=Buffer.isBuffer(e)?e:Buffer.from(e,t);this.buffers.push(n);r()},flush:e=>{try{const t=Buffer.concat(this.buffers).toString();i("%s",t);const r=global.JSON.parse(t);e(null,r)}catch(t){e(t)}}});this.count=0;this.buffers=[]}}t.default=JSON},923:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});const n=r(357);const s=r(87);const o=r(622);const i=r(972);const a=r(93);const u=r(327);const c=r(383);const l=process.platform==="win32";class Pattern{constructor(e,t){this.negate=false;let r;if(typeof e==="string"){r=e.trim()}else{t=t||[];n(t.length,`Parameter 'segments' must not empty`);const s=Pattern.getLiteral(t[0]);n(s&&i.hasAbsoluteRoot(s),`Parameter 'segments' first element must be a root path`);r=new c.Path(t).toString().trim();if(e){r=`!${r}`}}while(r.startsWith("!")){this.negate=!this.negate;r=r.substr(1).trim()}r=Pattern.fixupPattern(r);this.segments=new c.Path(r).segments;this.trailingSeparator=i.normalizeSeparators(r).endsWith(o.sep);r=i.safeTrimTrailingSeparator(r);let s=false;const u=this.segments.map(e=>Pattern.getLiteral(e)).filter(e=>!s&&!(s=e===""));this.searchPath=new c.Path(u).toString();this.rootRegExp=new RegExp(Pattern.regExpEscape(u[0]),l?"i":"");const f={dot:true,nobrace:true,nocase:l,nocomment:true,noext:true,nonegate:true};r=l?r.replace(/\\/g,"/"):r;this.minimatch=new a.Minimatch(r,f)}match(e){if(this.segments[this.segments.length-1]==="**"){e=i.normalizeSeparators(e);if(!e.endsWith(o.sep)){e=`${e}${o.sep}`}}else{e=i.safeTrimTrailingSeparator(e)}if(this.minimatch.match(e)){return this.trailingSeparator?u.MatchKind.Directory:u.MatchKind.All}return u.MatchKind.None}partialMatch(e){e=i.safeTrimTrailingSeparator(e);if(i.dirname(e)===e){return this.rootRegExp.test(e)}return this.minimatch.matchOne(e.split(l?/\\+/:/\/+/),this.minimatch.set[0],true)}static globEscape(e){return(l?e:e.replace(/\\/g,"\\\\")).replace(/(\[)(?=[^/]+\])/g,"[[]").replace(/\?/g,"[?]").replace(/\*/g,"[*]")}static fixupPattern(e){n(e,"pattern cannot be empty");const t=new c.Path(e).segments.map(e=>Pattern.getLiteral(e));n(t.every((e,t)=>(e!=="."||t===0)&&e!==".."),`Invalid pattern '${e}'. Relative pathing '.' and '..' is not allowed.`);n(!i.hasRoot(e)||t[0],`Invalid pattern '${e}'. Root segment must not contain globs.`);e=i.normalizeSeparators(e);if(e==="."||e.startsWith(`.${o.sep}`)){e=Pattern.globEscape(process.cwd())+e.substr(1)}else if(e==="~"||e.startsWith(`~${o.sep}`)){const t=s.homedir();n(t,"Unable to determine HOME directory");n(i.hasAbsoluteRoot(t),`Expected HOME directory to be a rooted path. Actual '${t}'`);e=Pattern.globEscape(t)+e.substr(1)}else if(l&&(e.match(/^[A-Z]:$/i)||e.match(/^[A-Z]:[^\\]/i))){let t=i.ensureAbsoluteRoot("C:\\dummy-root",e.substr(0,2));if(e.length>2&&!t.endsWith("\\")){t+="\\"}e=Pattern.globEscape(t)+e.substr(2)}else if(l&&(e==="\\"||e.match(/^\\[^\\]/))){let t=i.ensureAbsoluteRoot("C:\\dummy-root","\\");if(!t.endsWith("\\")){t+="\\"}e=Pattern.globEscape(t)+e.substr(1)}else{e=i.ensureAbsoluteRoot(Pattern.globEscape(process.cwd()),e)}return i.normalizeSeparators(e)}static getLiteral(e){let t="";for(let r=0;r<e.length;r++){const n=e[r];if(n==="\\"&&!l&&r+1<e.length){t+=e[++r];continue}else if(n==="*"||n==="?"){return""}else if(n==="["&&r+1<e.length){let n="";let s=-1;for(let t=r+1;t<e.length;t++){const r=e[t];if(r==="\\"&&!l&&t+1<e.length){n+=e[++t];continue}else if(r==="]"){s=t;break}else{n+=r}}if(s>=0){if(n.length>1){return""}if(n){t+=n;r=s;continue}}}t+=n}return t}static regExpEscape(e){return e.replace(/[[\\^$.|?*+()]/g,"\\$&")}}t.Pattern=Pattern},960:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const s=n(r(453));const o=n(r(325));(async()=>{console.log("::echo::%s",process.env["RUNNER_DEBUG"]==="1"?"on":"off");try{process.exitCode=await new s.default(o.default).execute()}catch(e){console.log("::error::%s",e);process.exitCode=1}finally{process.exit()}})()},972:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});const n=r(357);const s=r(622);const o=process.platform==="win32";function dirname(e){e=safeTrimTrailingSeparator(e);if(o&&/^\\\\[^\\]+(\\[^\\]+)?$/.test(e)){return e}let t=s.dirname(e);if(o&&/^\\\\[^\\]+\\[^\\]+\\$/.test(t)){t=safeTrimTrailingSeparator(t)}return t}t.dirname=dirname;function ensureAbsoluteRoot(e,t){n(e,`ensureAbsoluteRoot parameter 'root' must not be empty`);n(t,`ensureAbsoluteRoot parameter 'itemPath' must not be empty`);if(hasAbsoluteRoot(t)){return t}if(o){if(t.match(/^[A-Z]:[^\\/]|^[A-Z]:$/i)){let e=process.cwd();n(e.match(/^[A-Z]:\\/i),`Expected current directory to start with an absolute drive root. Actual '${e}'`);if(t[0].toUpperCase()===e[0].toUpperCase()){if(t.length===2){return`${t[0]}:\\${e.substr(3)}`}else{if(!e.endsWith("\\")){e+="\\"}return`${t[0]}:\\${e.substr(3)}${t.substr(2)}`}}else{return`${t[0]}:\\${t.substr(2)}`}}else if(normalizeSeparators(t).match(/^\\$|^\\[^\\]/)){const e=process.cwd();n(e.match(/^[A-Z]:\\/i),`Expected current directory to start with an absolute drive root. Actual '${e}'`);return`${e[0]}:\\${t.substr(1)}`}}n(hasAbsoluteRoot(e),`ensureAbsoluteRoot parameter 'root' must have an absolute root`);if(e.endsWith("/")||o&&e.endsWith("\\")){}else{e+=s.sep}return e+t}t.ensureAbsoluteRoot=ensureAbsoluteRoot;function hasAbsoluteRoot(e){n(e,`hasAbsoluteRoot parameter 'itemPath' must not be empty`);e=normalizeSeparators(e);if(o){return e.startsWith("\\\\")||/^[A-Z]:\\/i.test(e)}return e.startsWith("/")}t.hasAbsoluteRoot=hasAbsoluteRoot;function hasRoot(e){n(e,`isRooted parameter 'itemPath' must not be empty`);e=normalizeSeparators(e);if(o){return e.startsWith("\\")||/^[A-Z]:/i.test(e)}return e.startsWith("/")}t.hasRoot=hasRoot;function normalizeSeparators(e){e=e||"";if(o){e=e.replace(/\//g,"\\");const t=/^\\\\+[^\\]/.test(e);return(t?"\\":"")+e.replace(/\\\\+/g,"\\")}return e.replace(/\/\/+/g,"/")}t.normalizeSeparators=normalizeSeparators;function safeTrimTrailingSeparator(e){if(!e){return""}e=normalizeSeparators(e);if(!e.endsWith(s.sep)){return e}if(e===s.sep){return e}if(o&&/^[A-Z]:\\$/i.test(e)){return e}return e.substr(0,e.length-1)}t.safeTrimTrailingSeparator=safeTrimTrailingSeparator},993:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const s=n(r(920));t.JSON=s.default;const o=n(r(7));t.Lines=o.default}});